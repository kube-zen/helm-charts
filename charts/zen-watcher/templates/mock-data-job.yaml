{{- if .Values.mockData.enabled }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "zen-watcher.fullname" . }}-mock-checkov-1
  namespace: {{ .Values.namespaces.checkov }}
  labels:
    app: checkov
    {{- include "zen-watcher.labels" . | nindent 4 }}
data:
  results.json: |
    {
      "results": {
        "failed_checks": [
          {
            "check_id": "CKV_K8S_24",
            "check_name": "Pod Security Policy",
            "resource": "Pod.default.demo-pod",
            "guideline": "Ensure Pod Security Policy is set",
            "severity": "high"
          }
        ]
      }
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "zen-watcher.fullname" . }}-mock-checkov-2
  namespace: {{ .Values.namespaces.checkov }}
  labels:
    app: checkov
    {{- include "zen-watcher.labels" . | nindent 4 }}
data:
  results.json: |
    {
      "results": {
        "failed_checks": [
          {
            "check_id": "CKV_K8S_12",
            "check_name": "Resource Limits",
            "resource": "Pod.default.demo-pod-2",
            "guideline": "CPU limits should be set",
            "severity": "medium"
          }
        ]
      }
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "zen-watcher.fullname" . }}-mock-kubebench-1
  namespace: {{ .Values.namespaces.kubeBench }}
  labels:
    app: kube-bench
    {{- include "zen-watcher.labels" . | nindent 4 }}
data:
  results.json: |
    {
      "Controls": [
        {
          "id": "1",
          "version": "CIS",
          "description": "Master Node Security",
          "tests": [
            {
              "section": "1",
              "type": "master",
              "results": [
                {
                  "test_number": "1.2.1",
                  "test_desc": "Ensure --anonymous-auth is false",
                  "remediation": "Edit API server and set --anonymous-auth=false",
                  "status": "FAIL",
                  "scored": true
                }
              ]
            }
          ]
        }
      ]
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "zen-watcher.fullname" . }}-mock-kubebench-2
  namespace: {{ .Values.namespaces.kubeBench }}
  labels:
    app: kube-bench
    {{- include "zen-watcher.labels" . | nindent 4 }}
data:
  results.json: |
    {
      "Controls": [
        {
          "id": "1",
          "version": "CIS",
          "description": "Master Node Security",
          "tests": [
            {
              "section": "1",
              "type": "master",
              "results": [
                {
                  "test_number": "1.2.2",
                  "test_desc": "Ensure --basic-auth-file is not set",
                  "remediation": "Remove --basic-auth-file parameter",
                  "status": "FAIL",
                  "scored": true
                }
              ]
            }
          ]
        }
      ]
    }
{{- end }}

